<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html>
<html>
<style>
.banner{
  overflow: hidden;
  background-color: white;

}
h1
{
color: white;
}
form
{
color: white;
}
body {
  background-color: #002e5d;
  position: fixed;
  color:white;
}
select {
width: 50%;
}
</style>
  <head>
    <title>BYU Smart Mirror</title>
    <div class="banner">
<img src="ece.png" alt="logo" height ="50" width="200">
    </div>
    
    <h1>Send a message to the Smart Mirror</h1>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" charset="utf-8">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.js" type="text/javascript"></script>
 	<script type = "text/javascript" 
         src = "https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    
    <script type = "text/javascript">


	function onFailure(message) {
        setTimeout(MQTTconnect, reconnectTimeout);
    }

	function onConnect() {
	connected_flag=1
	}

    function MQTTconnect() {

	mqtt = new Paho.MQTT.Client(host,port,"web_" + parseInt(Math.random() * 100, 10));

	var options = {
		onSuccess: onConnect,
		onFailure: onFailure,
        useSSL: true,
     };	
        options.userName = "messages";        
        options.password = "yMk7upKt2dcGEao3u2uxvXC4KnQRL224";        

	mqtt.connect(options);
	return false;
  
 
	}

	function send_message(){
		var msg = document.forms["smessage"]["message"].value;
		console.log(msg);

		var topic = "immerse/messages";
		message = new Paho.MQTT.Message(msg);
		message.destinationName = topic;
		mqtt.send(message);
		return false;
	}

	function pass_message() {
        var p = document.forms["p"]["pass"].value;
        if(p == "immerse") {
            var msg = document.forms["p"]["mess"].value;
		    console.log(msg);

		    var topic = "immerse/messages";
		    message = new Paho.MQTT.Message(msg);
		    message.destinationName = topic;
		    mqtt.send(message);
		    return false;
        }
    }
    </script>

  </head>

    <script type = "text/javascript">
    </script>
	<script>
	var mqtt;
    var reconnectTimeout = 2000;
	var host="postman.cloudmqtt.com";
	var port=37408;
	</script>
 
<script>
    MQTTconnect();
</script>
<body>

<form name="smessage" action="" onsubmit="return send_message()" >
<select type="text" name="message">
  <option>Looking Good!</option>
  <option>Nice to see you</option>
  <option>I love that outfit</option>
  <option>You sure enjoy looking at yourself</options>
</select><br>
<input type="submit" value="Submit"><br><br>
</form>
<form name="p" action="" onsubmit="return pass_message()">
Password: <input type="text" name="pass"><br>
Message: <input type="text" name="mess"><br>
<input type="submit" value="Submit">
</form>
  </body>
</html>
